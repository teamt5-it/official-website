<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>TeamT5 - Persistent Cyber Threat Hunters</title>
  <meta
    name="description"
    content="TeamT5 is a group of hackers dedicated on cyber threat research. The team started with their outstanding research and has been delivering their cyber threat intelligence (CTI) for more than 5 years."
  />
  <meta
    name="keywords"
    content="TeamT5, ThreatSonar, ThreatVision, cyber espionage, TT, Cyber Threat Hunters, cyber espionage solutions, threat analysis service, incident response, investigation services, threat intelligence, Elegant Threat Hunting Technology"
  />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta
    property="og:title"
    content="TeamT5 - Persistent Cyber Threat Hunters"
  />
  <meta
    property="og:description"
    content="TeamT5 is a group of hackers dedicated on cyber threat research. The team started with their outstanding research and has been delivering their cyber threat intelligence (CTI) for more than 5 years."
  />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="/assets/images/og-image.jpg" />
  <link
    href="https://fonts.googleapis.com/css?family=Noto+Sans+TC:400,500,700&display=swap&subset=chinese-traditional"
    rel="stylesheet"
  />
  <link rel="icon" type="image/icon" href="/assets/images/favicon.ico" />
  <link rel="stylesheet" type="text/css" href="/assets/main-7383437ebdec817d69f1db11a083c62e3d6f5c775a35fc8ee18b88c67dc2c866.css" integrity="sha256-c4NDfr3sgX1p8dsRoIPGLj1vXHdaNfyO4YuIxn3CyGY=" crossorigin="anonymous"> <script integrity="sha256-ZXwkbee/Uwspyw5FDzhhG6YQBtn5LFRLCRt2xMtBSIk=" crossorigin="anonymous" src="/assets/main-657c246de7bf530b29cb0e450f38611ba61006d9f92c544b091b76c4cb414889.js" type="text/javascript"></script>
</head>


<body>
  <div class="header-container">
    <header class="navbar">
    <div class="navbar-brand-and-menu">

        <div class="navbar-brand">
            <a class="navbar-brand-logo" href="/">
                <object data="/assets/header/header-logo-3b363715bccbf56e1d1f26d37b954be04245a4e6bf74e4e5dc466c8fc624aa6b.svg">
                </object>
            </a>
            <div class="navbar-burger">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </div>
        </div>
        <div class="navbar-menu">
            <div class="navbar-item navbar-item-has-submenu">
                <div class="navbar-item-link
            
                
            ">
                    <div class="navbar-item-title title">
                        Products
                    </div>
                    <div class="navbar-item-arrow">
                        <object data="/assets/arrow-down-grey-color-c386e3d166125119750898fef68303e4aeafc8670b11bccdd778363c6e02f8b9.svg">
                        </object>
                    </div>
                </div>
                <div class="navbar-submenu">
                    <a class="navbar-submenu-item-link" href="/products/threatsonar/">
                        <div class="navbar-submenu-item title">
                            ThreatSonar
                        </div>
                    </a>
                    <a class="navbar-submenu-item-link" href="/products/threatvision/">
                        <div class="navbar-submenu-item title">
                            ThreatVision
                        </div>
                    </a>
                </div>
            </div>
            <div class="navbar-item">
                <a class="navbar-item-link
            
            " href="/partners/">
                    <div class="navbar-item-title title">
                        Partners
                    </div>
                </a>
            </div>
            <div class="navbar-item">
                <a class="navbar-item-link
            
            " href="/blog/">
                    <div class="navbar-item-title title">
                        Blog
                    </div>
                </a>
            </div>
            <div class="navbar-item navbar-item-has-submenu">
                <div class="navbar-item-link

            
                
            ">
                    <div class="navbar-item-title title">
                        Company</div>
                    <div class="navbar-item-arrow">
                        <object data="/assets/arrow-down-grey-color-c386e3d166125119750898fef68303e4aeafc8670b11bccdd778363c6e02f8b9.svg">
                        </object>
                    </div>
                </div>
                <div class="navbar-submenu">
                    <a class="navbar-submenu-item-link" href="/about-us/">
                        <div class="navbar-submenu-item title">
                            About us
                        </div>
                    </a>
                    <a class="navbar-submenu-item-link" href="/contact-us/">
                        <div class="navbar-submenu-item title">
                            Contact us
                        </div>
                    </a>
                    <a class="navbar-submenu-item-link" href="/careers/">
                        <div class="navbar-submenu-item title">
                            Careers
                        </div>
                    </a>
                    <a class="navbar-submenu-item-link" href="/newsroom/">
                        <div class="navbar-submenu-item title">
                            Newsroom
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <div class="navbar-submenu-padding">
        <div class="navbar-submenu-padding-box">

        </div>
    </div>
</header>

  </div>
  <div class="main-container">
    <div class="post-page-title-container">
    <div class="post-page-title">
        <div class="post-page-title-content title title-leftline ">
            ASUS Supply-Chain Attack: A Technical Look Inside
        </div>
    </div>
</div>

<main class="post-layout">
    <div class="post-meta">
        
        <div class="tags">
            
            <span class="tag">
                case study
            </span>
            
        </div>
        
        <div class="post-date date">
            2019/03/28
        </div>
    </div>
    <div class="post-banner">
        <img class="lazy" data-src="/assets/images/startup-593324_1920.jpg">
    </div>
    <div class="post-content content">
        <p>photo courtesy of: pixabay.com</p>

<p>Asus, one of the world’s largest computer makers, was believed to be the newest victim of a supply chain attack. According to the up-to-date blog of Kaspersky [1], ASUS Live Software Server was compromised by attackers to install malicious backdoors on customers’ devices.</p>

<p>IIt was alleged that the malware was delivered to millions of Asus computers, although the attackers targeted only 600 specific MAC addresses. This phenomenon has been observed in several supply chain attacks associated with China-backed APT actors, such as CCleaner and NetSarang supply chain attacks in 2017.</p>

<p>TeamT5 found several samples of this serial attack and performed technical analysis on it. The C2 is https://asushotfix[.]com, which was shut down during our analysis. Thus, we are not able to provide further information at this time.</p>

<p><img src="/assets/images/02_01.png" alt="Figure 1: Shellcode encoding routine in ASUS sample, which is the same in PlugX Fast version" title="Figure 1: Shellcode encoding routine in ASUS sample, which is the same in PlugX Fast version" />
<em>Figure 1: Shellcode encoding routine in ASUS sample, which is the same in PlugX Fast version</em></p>

<p>The result indicates this attack was possibly carried out by Chinese hackers since they used PlugX Crypt for the shellcode derived from the file. Besides, TeamT5 observed several similar techniques between this attack and the previous cases, such as inserting malicious shellcode in the run-time initialization routine in C program. TeamT5 strongly believes that this supply chain attack on ASUS system was backed by China government and can be linked to the CCleaner and NetSarang attacks.</p>

<p>From the C2 domain activation history, TeamT5 believes the initial campaign started from May 2018 and ended in around Oct 2018. However, the computers in the target list will be implanted with other malwares and keep being controlled by the threat actors. The only knowledge regarding the targets is a list of MAC address hashes and they could not be mapped to organizations or individuals. We urge our clients to check the IDS/IPS or try to use TeamT5’s ThreatSonar to scan for further detection and defence.</p>

<h3 id="reference">Reference</h3>

<p>[1] https://securelist.com/operation-shadowhammer/89992/</p>

<h4 id="appendix"><strong>Appendix</strong></h4>

<p>Indicator of Compromise (IoC)</p>

<p><strong>C2 Domains and IPs:</strong></p>

<ul>
  <li>asushotfix[.]com</li>
  <li>simplexoj[.]com</li>
  <li>homeabcd[.]com</li>
  <li>35.154.92[.]115</li>
  <li>141.105.71[.]116</li>
</ul>

<p><strong>Malicious download links:</strong></p>

<ul>
  <li>hxxp://liveupdate01.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER365.zip</li>
  <li>hxxps://liveupdate01s.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER362.zip</li>
  <li>hxxps://liveupdate01s.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER360.zip</li>
  <li>hxxps://liveupdate01s.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER359.zip</li>
</ul>

<p>Hashes（MD5）:</p>

<ul>
  <li>5855362028a58d8760c9ea2dcdf37af5</li>
  <li>0db57cc899ae7385c60b16a62b748a18</li>
  <li>c0116d877d048b1ba87c0de6fd7c3fb2</li>
  <li>7df9736f60a979eee5b90d6c53dc9374</li>
  <li>56a046f11c84c691295267dcf1f00c4a</li>
  <li>fa83ffde24f149f9f6d1d8bc05c0e023</li>
  <li>17a36ac3e31f3a18936552aff2c80249</li>
  <li>2a95475af7a07ee95ab11caad9e99b0c</li>
  <li>0f49621b06f2cdaac8850c6e9581a594</li>
  <li>f2f879989d967e03b9ea0938399464ab</li>
  <li>06c19cd73471f0db027ab9eb85edc607</li>
  <li>63f2fe96de336b6097806b22b5ab941a</li>
  <li>9c74402572344aee9018587188fe441e</li>
  <li>bd809a2abb1eda0e28becc1661b96581</li>
  <li>8baa46d0e0faa2c6a3f20aeda2556b18</li>
  <li>cdb0a09067877f30189811c7aea3f253</li>
  <li>aa15eb28292321b586c27d8401703494</li>
  <li>8756bafa7f0a9764311d52bc792009f9</li>
  <li>2ec9d0df80df005becbd37142811e43b</li>
  <li>55a7aa5f0e52ba4d78c145811c830107</li>
  <li>915086d90596eb5903bcd5b02fd97e3e</li>
  <li>5220c683de5b01a70487dac2440e0ecb</li>
  <li>5855ce7c4a3167f0e006310eb1c76313</li>
</ul>

<p><strong>Thumbprint of abused certificate:</strong></p>

<ul>
  <li>626646d29c5b0e7c53aa84698a4a97be323cf17f</li>
</ul>

<p>Yara rule:</p>

<pre><code class="language-yara">rule apt_trojan_AsusSetup_encoder
{
  strings:
    $plugx_crypt = { 55 8BEC 81EC 08010000 53 56 57 8DBD F8FEFFFF B9 42000000 B8 CCCCCCCC F3 AB C745 F8 00000000 C745 EC 00000000 8B45 08 8B08 894D E0 8B45 08 8B08 894D D4 8B45 08 8B08 894D C8 8B45 08 8B08 894D BC 8B45 E0 C1E8 03 8B4D E0 8D9401 EFEEEEEE 8955 E0 8B45 D4 C1E8 05 8B4D D4 8D9401 DEDDDDDD 8955 D4 8B45 C8 C1E0 07 B9 33333333 2BC8 034D C8 894D C8 8B45 BC C1E0 09 B9 44444444 2BC8 034D BC 894D EC 8B45 EC 8945 BC 8B45 08 0345 F8 0FB608 8B55 E0 81E2 FF000000 0FB6C2 8B55 D4 81E2 FF000000 0FB6D2 03C2 8B55 C8 81E2 FF000000 0FB6D2 03C2 8B55 EC 81E2 FF000000 0FB6D2 03C2 33C8 8B45 10 0345 F8 8808 8B45 F8 83C0 01 8945 F8 8B45 F8 3B45 0C 0F8C 50FFFFFF 5F 5E 5B 8BE5 5D C2 0C00 }

  condition:
    all of them
}

rule apt_trojan_AsusSetup_memory
{
  strings:
    $plugx_crypt = { 55 8BEC 81EC 08010000 53 56 57 8DBD F8FEFFFF B9 42000000 B8 CCCCCCCC F3 AB C745 F8 00000000 C745 EC 00000000 8B45 08 8B08 894D E0 8B45 08 8B08 894D D4 8B45 08 8B08 894D C8 8B45 08 8B08 894D BC 8B45 E0 C1E8 03 8B4D E0 8D9401 EFEEEEEE 8955 E0 8B45 D4 C1E8 05 8B4D D4 8D9401 DEDDDDDD 8955 D4 8B45 C8 C1E0 07 B9 33333333 2BC8 034D C8 894D C8 8B45 BC C1E0 09 B9 44444444 2BC8 034D BC 894D EC 8B45 EC 8945 BC 8B45 08 0345 F8 0FB608 8B55 E0 81E2 FF000000 0FB6C2 8B55 D4 81E2 FF000000 0FB6D2 03C2 8B55 C8 81E2 FF000000 0FB6D2 03C2 8B55 EC 81E2 FF000000 0FB6D2 03C2 33C8 8B45 10 0345 F8 8808 8B45 F8 83C0 01 8945 F8 8B45 F8 3B45 0C 0F8C 50FFFFFF 5F 5E 5B 8BE5 5D C2 0C00 }

  condition:
    all of them
}
</code></pre>

<h4 id="how-to-use-ioc-in-threatsonar">How to use IOC in ThreatSonar</h4>

<p>A. You can import IOCs into ThreatSonar and launch “Retro Hunt” to see if there is any matches.</p>

<p><img src="/assets/images/02_02.png" alt="Import IOC into ThreatSonar Intel." title="Import IOC into ThreatSonar Intel." />
<em>Import IOC into ThreatSonar Intel.</em></p>

<p>B. The malware is using valid “ASUSTek” certificate, the thumbprint of the certificate can be searched in “Hunter” page.</p>

<p><img src="/assets/images/02_03.png" alt="Details of abused certificate." title="Details of abused certificate." />
<em>Details of abused certificate.</em></p>

<p>In “Hunter” page, you are able to search “thumbprint = 626646d29c5b0e7c53aa84698a4a97be323cf17f” by switching scope to “Certificate” (Please select “Engine Version” to All).</p>

<p>p.s. If you find any matched results, don’t hesitate to contact with us.</p>

<p><img src="/assets/images/02_04.png" alt="Thumbprint matched endpoints and programs." title="Thumbprint matched endpoints and programs." />
<em>Thumbprint matched endpoints and programs.</em>
<img src="/assets/images/02_05.png" alt="The related thumbprint was found." title="The related thumbprint was found." />
<em>The related thumbprint was found.</em></p>

<p>C. To use the yara rule, just create yara ruleset, then copy and paste the yara rule listed above.</p>

<p><img src="/assets/images/02_06.png" alt="Import the yara rule." title="Import the yara rule." />
<em>Import the yara rule.</em></p>

    </div>
    
    <a class="back-button button">
        Back
    </a>
</main>

  </div>
  <div class="footer-container">
    <footer class="footer">
    <div class="footer-logo-and-menu">
        <a class="footer-logo" href="/">
            <object data="/assets/footer/footer-logo-7feae84ff8f4616ae82197cdcb4b63d2af93c4d247b9106328f14c734e270d62.svg">
            </object>
        </a>
        <div class="footer-menu">
            <div class="footer-item">
                <div class="footer-item-title">Products</div>
                <a class="footer-item-link" href="/products/threatsonar/">ThreatSonar</a>
                <a class="footer-item-link" href="/products/threatvision/">ThreatVision</a>

            </div>
            <div class="footer-item">
                <a class="footer-item-title footer-item-link" href="/partners/">Partners</a>
                <a class="footer-item-title footer-item-link" href="/blog/">Blog</a>
            </div>
            <div class="footer-item">
                <div class="footer-item-title">Company</div>
                <a class="footer-item-link" href="/about-us/">About us</a>
                <a class="footer-item-link"
                    href="/contact-us/">Contact us</a>
                <a class="footer-item-link" href="/careers/">Careers</a>
                <a class="footer-item-link" href="/newsroom/">Newsroom</a>
            </div>
        </div>
    </div>
    <hr class="footer-hr">
    <div class="footer-informations-and-language-selector">
        <div class="footer-informations">
            <div class="footer-copyright">
                © 2019 Team T5, Inc. (Doppler Cyber Threat Solutions Inc.) All Rights Reserved.
            </div>
            <div class="footer-privacy-and-cookies-policy">
                <a href="/privacy-and-cookies-policy/">Privacy & Cookies Policy</a>
            </div>
            <div class="footer-terms-of-service">
                <a href="/terms-of-service/">Terms of Service</a>
            </div>
        </div>
        <select class="footer-language-selector" id="language-selector">
            <option value="en">English</option>
            <option value="zh">中文</option>
        </select>
    </div>
    <div class="scroll-top">
        <div class="scroll-top-square rotate-clockwise-45">
            <div class="scroll-top-content rotate-counterwise-45">
                <object class="scroll-top-arrow" data="/assets/arrow-up-78bf1dbc7f5b78b1750c58ebad959a4caea323d635c30863521203c878f2ab97.svg">
                </object>
                <div class="scroll-top-text">
                    TOP
                </div>
            </div>
        </div>
    </div>
</footer>

  </div>
</body>

</html>
